<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enchanted Date Picker</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Pacifico&display=swap" rel="stylesheet">
    <style>
        /* ===== VARIABLES ===== */
        :root {
            --primary: #9b4d96;
            --secondary: #f5a9bc;
            --dark: #2a0a3a;
            --light: #fce4ec;
            --accent: #e91e63;
        }

        /* ===== BASE STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f5d6e8, #f1a1c2);
            color: #333;
            min-height: 100vh;
            padding-left: 100px; /* Space for left nav */
            padding-right: 100px; /* Space for right nav */
            line-height: 1.6;
            overflow-x: hidden; /* Prevent horizontal scroll from navs */
        }

        /* ===== LEFT NAVIGATION BAR ===== */
        .nav-container-left {
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            width: 100px;
            background: var(--dark);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 30px;
            z-index: 1000;
            box-shadow: 5px 0 15px rgba(0,0,0,0.1);
            border-right: 3px solid var(--secondary);
        }

        /* ===== RIGHT NAVIGATION BAR ===== */
        .nav-container-right {
            position: fixed;
            right: 0;
            top: 0;
            height: 100vh;
            width: 100px;
            background: var(--dark);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 30px;
            z-index: 1000;
            box-shadow: -5px 0 15px rgba(0,0,0,0.1);
            border-left: 3px solid var(--secondary);
        }

        .nav-item { /* Common style for all nav items */
            width: 100%;
            text-align: center;
            padding: 15px 0;
            margin: 8px 0;
            color: white;
            font-size: 0.85rem;
            text-decoration: none;
            transition: all 0.3s ease;
            border-radius: 0 8px 8px 0; 
        }
        .nav-container-right .nav-item {
             border-radius: 8px 0 0 8px; 
        }
        .nav-item:hover { background: var(--primary); }
        .nav-container-left .nav-item:hover { transform: translateX(5px); }
        .nav-container-right .nav-item:hover { transform: translateX(-5px); }
        .nav-item img { width: 40px; height: 40px; object-fit: contain; margin-bottom: 5px; filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2)); }
        .active { background: var(--accent); font-weight: 600; }

        /* ===== MAIN CONTENT ===== */
        .page-wrapper { max-width: 900px; margin: 0 auto; padding: 30px; }
        .container {
            background: rgba(255,255,255,0.9); border-radius: 20px; padding: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.3); position: relative;
        }
        h1 { color: var(--primary); font-family: 'Pacifico', cursive; margin-bottom: 25px; font-size: 2.8rem; text-align: center; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); }
        .intro-text { text-align: center; margin-bottom: 30px; color: #555; font-size: 1.1rem; }

        /* ===== MOOD SELECTOR & BUTTONS ===== */
        .mood-selector { display: flex; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 25px 0; }
        .mood-btn {
            background: linear-gradient(135deg, var(--secondary), #e67fa1); color: white; border: none; padding: 12px 25px; font-size: 1rem;
            border-radius: 50px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            min-width: 140px; font-weight: 500; display: flex; align-items: center; justify-content: center;
        }
        .mood-btn:hover { transform: translateY(-3px); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
        .mood-btn.active { background: linear-gradient(135deg, var(--primary), #7c3c79); font-weight: 600; }
        .main-btn {
            background: linear-gradient(135deg, var(--primary), #7c3c79); color: white; border: none; padding: 14px 32px; font-size: 1.1rem;
            border-radius: 50px; cursor: pointer; margin: 10px auto; 
            transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(0,0,0,0.15); font-weight: 600; display: block; 
        }
        .main-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 16px rgba(0,0,0,0.2); }
        .button-group { display: flex; flex-direction: column; align-items: center; gap: 10px; margin-top: 20px; }

        .spicy-toggle-container { display: flex; justify-content: center; align-items: center; gap: 10px; margin: 15px 0; }
        .spicy-toggle { position: relative; display: inline-block; width: 60px; height: 30px; }
        .spicy-toggle input { opacity: 0; width: 0; height: 0; }
        .spicy-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #f5a9bc; transition: .4s; border-radius: 34px; }
        .spicy-slider:before { position: absolute; content: ""; height: 22px; width: 22px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .spicy-slider { background-color: var(--accent); }
        input:checked + .spicy-slider:before { transform: translateX(30px); }
        .spicy-label { font-weight: 600; color: var(--dark); }
        .result-card { background: white; border-radius: 15px; padding: 30px; margin: 30px 0; box-shadow: 0 5px 20px rgba(0,0,0,0.08); border: 1px solid rgba(0,0,0,0.05); display: none; animation: fadeIn 0.6s ease-out; position: relative; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .date-idea { color: var(--accent); font-family: 'Pacifico', cursive; font-size: 2rem; margin-bottom: 15px; text-align: center; }
        .description { background: var(--light); padding: 20px; border-radius: 10px; margin: 20px 0; font-size: 1.05rem; position: relative; }
        .description:before { content: ""; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: linear-gradient(to bottom, var(--accent), var(--primary)); border-radius: 4px 0 0 4px; }
        .spicy-description { background: #ffebee; border-left: 4px solid var(--accent); font-style: italic; margin-top: 15px; padding: 15px; border-radius: 8px; display: none; }
        .form-container { display: none; background: white; border-radius: 15px; padding: 30px; margin: 30px 0; box-shadow: 0 5px 20px rgba(0,0,0,0.08); animation: fadeIn 0.6s ease-out; position: relative; }
        .form-title { color: var(--primary); font-family: 'Pacifico', cursive; font-size: 1.8rem; margin-bottom: 20px; text-align: center; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: var(--dark); font-weight: 600; }
        input, select, textarea { width: 100%; padding: 14px 18px; border: 2px solid var(--secondary); border-radius: 10px; font-size: 1rem; transition: all 0.3s; }
        input:focus, select:focus, textarea:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 3px rgba(155,77,150,0.2); }
        textarea { min-height: 120px; resize: vertical; }
        .confirmation-card { display: none; background: #e8f5e9; border-radius: 15px; padding: 30px; margin: 30px 0; box-shadow: 0 5px 20px rgba(0,0,0,0.08); border: 1px solid rgba(0,0,0,0.05); animation: fadeIn 0.6s ease-out; text-align: center; position: relative; }
        .confirmation-title { color: #2e7d32; font-family: 'Pacifico', cursive; font-size: 2rem; margin-bottom: 15px; }
        .confirmation-details { margin: 15px 0; line-height: 1.8; }
        .confirmation-details span { font-weight: 600; color: var(--dark); }
        .suggestion-form { display: none; background: white; border-radius: 15px; padding: 30px; margin: 30px 0; box-shadow: 0 5px 20px rgba(0,0,0,0.08); animation: fadeIn 0.6s ease-out; position: relative; }
        .suggestion-form h2 { color: var(--primary); font-family: 'Pacifico', cursive; font-size: 1.8rem; margin-bottom: 20px; text-align: center; }
        .hearts-container { position: fixed; width: 100%; height: 100%; top: 0; left: 0; pointer-events: none; z-index: -1; overflow: hidden; }
        .heart { position: absolute; color: var(--secondary); font-size: 24px; opacity: 0; bottom: -50px; animation: floatUpDatePage 8s linear infinite; }
        @keyframes floatUpDatePage { 0% { transform: translateY(0) scale(0.5) rotate(0deg); opacity: 0; } 10% { opacity: 0.8; } 90% { opacity: 0.8; } 100% { transform: translateY(-120vh) scale(1.2) rotate(360deg); opacity: 0; } }
        .bow { position: absolute; width: 40px; height: 40px; background: url('https://i.imgur.com/tA7aPg4.png') center/contain no-repeat; z-index: 10; }
        .container-bow-tl { top: -15px; left: -15px; } .container-bow-tr { top: -15px; right: -15px; }
        .container-bow-bl { bottom: -15px; left: -15px; } .container-bow-br { bottom: -15px; right: -15px; }
        .card-bow-tl { top: -10px; left: -10px; width: 30px; height: 30px; } .card-bow-tr { top: -10px; right: -10px; width: 30px; height: 30px; }
        .card-bow-bl { bottom: -10px; left: -10px; width: 30px; height: 30px; } .card-bow-br { bottom: -10px; right: -10px; width: 30px; height: 30px; }
        .loading-indicator { text-align: center; font-style: italic; color: var(--primary); margin: 20px; display: none; }

        /* ===== Scheduled Dates List Styles ===== */
        #scheduledDatesDisplay { 
            margin-top: 30px;
            background-color: #e6e6fa; 
            border-left: 4px solid var(--primary);
            padding: 20px; 
        }
        #scheduledDatesDisplay .date-idea { 
            color: var(--primary);
            font-size: 1.8em; 
            margin-bottom: 20px;
        }
        #scheduledDatesList ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        #scheduledDatesList li.scheduled-date-item { 
            background-color: #ffffff; 
            border: 1px solid var(--secondary);
            border-left: 5px solid var(--accent); 
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 18px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.08);
            text-align: left; 
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        #scheduledDatesList li.scheduled-date-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.12);
        }
        #scheduledDatesList li.scheduled-date-item h4 { 
            color: var(--primary); 
            margin-bottom: 10px;
            font-family: 'Pacifico', cursive; 
            font-size: 1.5em; 
            border-bottom: 1px dashed var(--secondary);
            padding-bottom: 8px;
        }
        #scheduledDatesList li.scheduled-date-item p {
            margin-bottom: 6px;
            font-size: 0.95em;
            color: #444; 
            line-height: 1.5;
        }
         #scheduledDatesList li.scheduled-date-item p strong {
            color: var(--dark);
            margin-right: 5px;
         }
        #scheduledDatesList li.scheduled-date-item .date-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 10px;
            margin-top: 10px;
        }
         #scheduledDatesList li.scheduled-date-item .date-detail {
            background-color: var(--light);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9em;
         }
        #scheduledDatesList li.scheduled-date-item em small { 
            color: #888;
            font-size: 0.8em;
            display: block;
            text-align: right;
            margin-top: 10px;
        }
        #scheduledDatesList .no-dates-message {
            text-align: center;
            font-style: italic;
            color: var(--dark);
            padding: 20px;
            background-color: #fff8fa;
            border-radius: 8px;
        }


        @media (max-width: 768px) {
            body { padding-left: 0; padding-right: 0; padding-bottom: 80px; }
            .nav-container-left, .nav-container-right { width: 100%; height: 80px; flex-direction: row; padding-top: 0; bottom: 0; top: auto; border-right: none; border-left: none; border-top: 3px solid var(--secondary); justify-content: space-around; }
            .nav-container-right { display: none; }
            .nav-container-left .nav-item { flex-grow: 1; border-radius: 0; margin: 0; }
            .nav-container-left .nav-item:hover { transform: none; }
            .nav-item { padding: 10px 0; font-size: 0; margin: 0; }
            .nav-item img { width: 30px; height: 30px; margin-bottom: 0; }
            .page-wrapper { padding: 15px; } .container { padding: 25px; }
            h1 { font-size: 2rem; } .mood-selector { flex-direction: column; align-items: center; }
            .mood-btn { width: 100%; max-width: 300px; } .bow { display: none; }
            .button-group { width: 100%; }
            .main-btn { width: 90%; max-width: 350px; }
             #scheduledDatesList li.scheduled-date-item .date-details-grid { grid-template-columns: 1fr; /* Stack details on mobile */ }
        }
        @media (max-width: 480px) {
            .mood-btn { padding: 10px 20px; font-size: 0.9rem; }
            .main-btn { padding: 12px 28px; font-size: 1rem; }
            .form-container, .result-card, .suggestion-form, .confirmation-card, #scheduledDatesDisplay { padding: 20px; }
            h1 { font-size: 1.8rem; } label { font-size: 0.9rem; }
            input, select, textarea { padding: 12px 15px; font-size: 0.9rem;}
             #scheduledDatesList li h4 { font-size: 1.3em;} /* Adjusted for mobile */
             #scheduledDatesList li p { font-size: 0.9em; }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
 <!-- Left Navigation -->
    <div class="nav-container-left">
        <a href="index.html" class="nav-item home"> <img src="https://i.imgur.com/ZAl2gbp.png" alt="Home"> Home </a>
        <a href="loveletters.html" class="nav-item letters"> <img src="https://i.imgur.com/ZVhcvD8.png" alt="Love Letters"> Love Letters </a>
        <a href="lovecalculator.html" class="nav-item calculator"> <img src="https://i.imgur.com/megzmKr.png" alt="Love Calculator"> Love Calculator </a>
        <a href="movies.html" class="nav-item movies"> <img src="https://i.imgur.com/gzW8uSH.png" alt="Movie Picker"> Movie Picker </a>
        <a href="bookdate.html" class="nav-item bookdate active"> <img src="https://i.imgur.com/megzmKr.png" alt="Book a Date"> Book a Date </a>
        <a href="timezone.html" class="nav-item timezone"> <img src="https://i.imgur.com/ZwOw9QN.png" alt="Time Bridge"> Time Bridge </a>
    </div>

    <!-- Main Content -->
    <div class="page-wrapper">
        <div class="container">
            <img src="https://i.imgur.com/tA7aPg4.png" class="bow container-bow-tl"> <img src="https://i.imgur.com/tA7aPg4.png" class="bow container-bow-tr">
            <img src="https://i.imgur.com/tA7aPg4.png" class="bow container-bow-bl"> <img src="https://i.imgur.com/tA7aPg4.png" class="bow container-bow-br">
            
            <h1>Enchanted Date Picker</h1>
            <p class="intro-text">Discover magical date ideas to keep our long-distance connection strong and passionate!</p>
            
            <div class="mood-selector">
                <button class="mood-btn" onclick="selectMood(this, 'virtual')"> <i class="fas fa-globe"></i>Â Virtual </button>
                <button class="mood-btn" onclick="selectMood(this, 'creative')"> <i class="fas fa-paint-brush"></i>Â Creative </button>
                <button class="mood-btn" onclick="selectMood(this, 'gaming')"> <i class="fas fa-gamepad"></i>Â Gaming </button>
                <button class="mood-btn" onclick="selectMood(this, 'spicy')"> <i class="fas fa-fire"></i>Â Spicy </button>
                <button class="mood-btn" onclick="selectMood(this, 'surprise')"> <i class="fas fa-gift"></i>Â Surprise Me </button>
            </div>
            
            <div class="loading-indicator" id="loadingIndicator">Fetching date ideas... âœ¨</div>

            <div class="button-group">
                <button class="main-btn" id="generateDateBtn" onclick="generateDate()"> <i class="fas fa-magic"></i> Create Our Date </button>
                <button class="main-btn" id="suggestDateBtn" onclick="showSuggestionForm()" style="background: linear-gradient(135deg, #6a4d9b, #4d7c9b);"> <i class="fas fa-lightbulb"></i> Suggest a Custom Date </button>
                <button class="main-btn" id="viewScheduledDatesBtn" style="background: linear-gradient(135deg, #4CAF50, #2E7D32);"> 
                    <i class="fas fa-calendar-alt"></i> View Our Scheduled Dates 
                </button>
            </div>
            
            <div class="result-card" id="result">
                <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-tl"> <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-tr">
                <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-bl"> <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-br">
                <div class="date-idea" id="dateIdea"></div> <div class="description" id="dateDescription"></div>
                <div class="spicy-toggle-container" id="spicyToggleContainer" style="display: none;">
                    <span class="spicy-label">Show Spicy Content</span>
                    <label class="spicy-toggle"> <input type="checkbox" id="spicyToggle"> <span class="spicy-slider"></span> </label>
                </div>
                <div class="spicy-description" id="spicyDescription"></div>
                <button class="main-btn" onclick="showBookingForm()"> <i class="far fa-calendar-plus"></i> Schedule This Date </button>
            </div>
            
            <div id="scheduledDatesDisplay" class="result-card" style="display: none;"> 
                <h2 class="date-idea" style="color: var(--primary);">Our Upcoming Adventures!</h2> 
                <div id="scheduledDatesList">
                    <p class="loading-indicator" style="display:block;">Loading scheduled dates...</p> 
                </div>
            </div>

            <div class="form-container" id="bookingForm">
                <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-tl"> <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-tr">
                <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-bl"> <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-br">
                <h2 class="form-title">Schedule Your Enchanted Date</h2>
                <form id="dateForm" onsubmit="submitBooking(event)">
                    <div class="form-group"> <label for="date"><i class="far fa-calendar-alt"></i> Date:</label> <input type="date" id="date" required> </div>
                    <div class="form-group"> <label for="time"><i class="far fa-clock"></i> Time:</label> <input type="time" id="time" required> </div>
                    <div class="form-group"> <label for="duration"><i class="fas fa-hourglass-half"></i> Duration:</label> <select id="duration" required> <option value="1 hour">1 hour</option> <option value="2 hours" selected>2 hours</option> <option value="3 hours">3 hours</option> <option value="4+ hours">4+ hours</option> </select> </div>
                    <div class="form-group"> <label for="platform"><i class="fas fa-video"></i> Platform:</label> <select id="platform" required> <option value="">Select...</option> <option>Zoom</option> <option>FaceTime</option> <option>Discord</option> <option>Google Meet</option> <option>Skype</option> <option>Other</option> </select> </div>
                    <div class="form-group"> <label for="email"><i class="fas fa-envelope"></i> Email (to send details):</label> <input type="email" id="email" required> </div>
                    <div class="form-group"> <label for="prep"><i class="fas fa-clipboard-list"></i> Prep Notes:</label> <textarea id="prep" placeholder="What should we both prepare?"></textarea> </div>
                    <button type="submit" class="main-btn"> <i class="fas fa-heart"></i> Confirm Our Date </button>
                </form>
            </div>
            
            <div class="suggestion-form" id="suggestionForm">
                 <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-tl"> <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-tr">
                <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-bl"> <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-br">
                <h2>Suggest a Custom Date Idea</h2>
                <form id="customDateForm" onsubmit="submitSuggestion(event)">
                    <div class="form-group"> <label for="suggestionTitle"><i class="fas fa-heading"></i> Date Title:</label> <input type="text" id="suggestionTitle" required placeholder="Date idea name"> </div>
                    <div class="form-group"> <label for="suggestionDescription"><i class="fas fa-align-left"></i> Description:</label> <textarea id="suggestionDescription" required placeholder="Describe the date"></textarea> </div>
                    <div class="form-group"> <label for="suggestionCategory"><i class="fas fa-tags"></i> Category:</label> <select id="suggestionCategory" required> <option value="">Select category...</option> <option value="virtual">Virtual</option> <option value="creative">Creative</option> <option value="gaming">Gaming</option> <option value="spicy">Spicy</option> </select> </div>
                    <div class="form-group"> <label for="suggestionSpicy"><i class="fas fa-fire"></i> Spicy Details (optional):</label> <textarea id="suggestionSpicy" placeholder="Optional spicy details"></textarea> </div>
                    <button type="submit" class="main-btn" style="background: linear-gradient(135deg, #6a4d9b, #4d7c9b);"> <i class="fas fa-paper-plane"></i> Submit Suggestion </button>
                    <button type="button" class="main-btn" onclick="hideSuggestionForm()"> <i class="fas fa-times"></i> Cancel </button>
                </form>
            </div>
            
            <div class="confirmation-card" id="suggestionConfirmation" style="display: none;">
                 <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-tl"> <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-tr">
                <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-bl"> <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-br">
                <h2 class="confirmation-title">Suggestion Sent! ðŸ’–</h2>
                <div class="confirmation-details"> <p>Your date idea is on its way to Tyler!</p> <p>Thanks for spicing things up!</p> </div>
                <button class="main-btn" onclick="resetForm()"> <i class="fas fa-plus-circle"></i> Back to Date Picker </button>
            </div>
            
            <div class="confirmation-card" id="confirmation">
                 <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-tl"> <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-tr">
                <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-bl"> <img src="https://i.imgur.com/tA7aPg4.png" class="bow card-bow-br">
                <h2 class="confirmation-title">Date Scheduled! âœ¨</h2>
                <div class="confirmation-details">
                    <p>Our <span id="confirmedIdea"></span> is set!</p>
                    <p><i class="far fa-calendar-check"></i> <span id="confirmedDate"></span></p> <p><i class="far fa-clock"></i> <span id="confirmedTime"></span></p>
                    <p><i class="fas fa-hourglass-end"></i> Duration: <span id="confirmedDuration"></span></p> <p><i class="fas fa-video"></i> Platform: <span id="confirmedPlatform"></span></p>
                    <p><i class="fas fa-envelope"></i> Sent to: <span id="confirmedEmail"></span></p> <p><i class="fas fa-clipboard-list"></i> Prep Notes: <span id="confirmedPrep"></span></p>
                </div>
                <button class="main-btn" onclick="resetForm()"> <i class="fas fa-plus-circle"></i> Plan Another Date </button>
            </div>
        </div>
    </div>
    
    <!-- Right Navigation Bar -->
    <div class="nav-container-right">
        <a href="slimegame.html" class="nav-item slimegame">
            <img src="https://i.imgur.com/yFzLbfM.png" alt="Slime Game Icon"> Slime Game
        </a>
    </div>

    <div class="hearts-container" id="hearts-container"></div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx7ZJD95q3L0nWY1zVdGsIgKkqmc8DPOvTYoZhpctCWRhkJT0Wh9fCzz0KpAp8qovhHBw/exec"; 
        
        let fetchedDateIdeas = { virtual: [], creative: [], gaming: [], spicy: [] };
        let allFetchedIdeas = []; 

        let selectedMood = '', currentIdea = '', currentDescription = '', currentSpicyDesc = '';
        
        async function loadDateIdeas() {
            const loadingIndicator = document.getElementById('loadingIndicator');
            const generateDateBtn = document.getElementById('generateDateBtn');
            
            if (loadingIndicator) loadingIndicator.style.display = 'block';
            if (generateDateBtn) generateDateBtn.disabled = true;

            try {
                const response = await fetch(`${SCRIPT_URL}?action=getDateIdeas&cb=${new Date().getTime()}`);
                if (!response.ok) {
                    throw new Error(`Network response was not ok: ${response.status} ${response.statusText}`);
                }
                const data = await response.json();

                if (data.status === "error") { 
                    throw new Error(`Error from Google Script: ${data.message}`);
                }
                
                fetchedDateIdeas = { virtual: [], creative: [], gaming: [], spicy: [] }; 
                allFetchedIdeas = [];

                data.forEach(item => {
                    const ideaObject = {
                        idea: item.ideaTitle || item.idea, 
                        description: item.description,
                        spicyDesc: item.spicyDesc || "" 
                    };
                    const category = item.category ? item.category.toLowerCase() : null;

                    if (category && fetchedDateIdeas[category]) {
                        fetchedDateIdeas[category].push(ideaObject);
                    }
                    allFetchedIdeas.push(ideaObject);
                });

                console.log("Date ideas loaded and categorized:", fetchedDateIdeas);
                if (loadingIndicator) loadingIndicator.style.display = 'none';
                if (generateDateBtn) generateDateBtn.disabled = false;

            } catch (error) {
                console.error('Failed to load date ideas:', error);
                if (loadingIndicator) loadingIndicator.textContent = 'Error loading ideas. Please try refreshing.';
            }
        }
        
        function selectMood(button, mood) { 
            document.querySelectorAll('.mood-btn').forEach(btn=>btn.classList.remove('active')); 
            button.classList.add('active'); 
            selectedMood=mood;
        }
        
        function generateDate() {
            let ideasAvailable = false;
            for (const categoryKey in fetchedDateIdeas) {
                if (fetchedDateIdeas[categoryKey] && fetchedDateIdeas[categoryKey].length > 0) {
                    ideasAvailable = true;
                    break;
                }
            }
            if (!ideasAvailable && allFetchedIdeas.length === 0) {
                 alert("Date ideas are still loading or failed to load. Please wait a moment or try refreshing the page.");
                return;
            }

            if (!selectedMood && selectedMood !== 'surprise') {
                alert("Please select a mood first!");
                return;
            }
            
            let ideasPool;
            if (selectedMood === 'surprise') {
                if (allFetchedIdeas.length === 0) {
                    alert("No ideas available for 'Surprise Me' yet!"); return;
                }
                ideasPool = allFetchedIdeas;
            } else {
                if (!fetchedDateIdeas[selectedMood] || fetchedDateIdeas[selectedMood].length === 0) {
                    alert(`No ideas available for the '${selectedMood}' mood yet! Try 'Surprise Me' or suggest one.`); return;
                }
                ideasPool = fetchedDateIdeas[selectedMood];
            }
            
            if (!ideasPool || ideasPool.length === 0) { 
                 alert("No ideas found for the selected criteria. This shouldn't happen if the previous checks passed!");
                 return;
            }

            const randomIdea = ideasPool[Math.floor(Math.random() * ideasPool.length)];
            
            document.getElementById('dateIdea').textContent = randomIdea.idea; 
            document.getElementById('dateDescription').textContent = randomIdea.description;
            
            const spicyToggleContainer = document.getElementById('spicyToggleContainer');
            if (randomIdea.spicyDesc) { 
                document.getElementById('spicyDescription').textContent = randomIdea.spicyDesc; 
                spicyToggleContainer.style.display = 'flex'; 
                document.getElementById('spicyToggle').checked = false; 
                document.getElementById('spicyDescription').style.display = 'none';
            } else { 
                spicyToggleContainer.style.display = 'none'; 
                document.getElementById('spicyDescription').style.display = 'none'; 
            }
            
            document.getElementById('result').style.display = 'block'; 
            document.getElementById('bookingForm').style.display = 'none'; 
            document.getElementById('confirmation').style.display = 'none';
            document.getElementById('suggestionForm').style.display = 'none'; 
            document.getElementById('suggestionConfirmation').style.display = 'none';
            document.getElementById('scheduledDatesDisplay').style.display = 'none';
            
            currentIdea = randomIdea.idea; 
            currentDescription = randomIdea.description; 
            currentSpicyDesc = randomIdea.spicyDesc || '';
            createHearts();
        }
        
        document.getElementById('spicyToggle').addEventListener('change', function() { 
            document.getElementById('spicyDescription').style.display = this.checked ? 'block' : 'none';
        });
        
        function showBookingForm() { 
            document.getElementById('bookingForm').style.display = 'block'; 
            const dateInput = document.getElementById('date');
            if(dateInput) dateInput.min = new Date().toISOString().split("T")[0];
            document.getElementById('bookingForm').scrollIntoView({ behavior: 'smooth' });
            document.getElementById('result').style.display = 'none';
            document.getElementById('scheduledDatesDisplay').style.display = 'none'; 
            document.getElementById('suggestionForm').style.display = 'none';
        }
        
        function showSuggestionForm() { 
            document.getElementById('suggestionForm').style.display = 'block'; 
            document.getElementById('result').style.display = 'none';
            document.getElementById('bookingForm').style.display = 'none'; 
            document.getElementById('confirmation').style.display = 'none';
            document.getElementById('suggestionConfirmation').style.display = 'none'; 
            document.getElementById('scheduledDatesDisplay').style.display = 'none';
            document.getElementById('suggestionForm').scrollIntoView({ behavior: 'smooth' });
        }
        function hideSuggestionForm() { 
            document.getElementById('suggestionForm').style.display = 'none'; 
            document.getElementById('customDateForm').reset();
        }
        
        async function submitBooking(event) { 
            event.preventDefault();
            const submitButton = event.target.querySelector('button[type="submit"]');
            const originalButtonText = submitButton.innerHTML;
            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Confirming...';

            const date = document.getElementById('date').value;
            const time = document.getElementById('time').value;
            const duration = document.getElementById('duration').value;
            const platform = document.getElementById('platform').value;
            const email = document.getElementById('email').value;
            const prep = document.getElementById('prep').value || "None needed";
            const showSpicy = document.getElementById('spicyToggle').checked;
            
            const startDateTime = new Date(`${date}T${time}`);
            const formattedDate = startDateTime.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' });
            const formattedTime = startDateTime.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
            
            document.getElementById('confirmedIdea').textContent=currentIdea; 
            document.getElementById('confirmedDate').textContent=formattedDate; 
            document.getElementById('confirmedTime').textContent=formattedTime;
            document.getElementById('confirmedDuration').textContent=duration; 
            document.getElementById('confirmedPlatform').textContent=platform; 
            document.getElementById('confirmedEmail').textContent=email; 
            document.getElementById('confirmedPrep').textContent=prep;

            const sheetData = {
                action: "scheduleDate", ideaTitle: currentIdea, scheduledDate: date, 
                scheduledTime: time, duration: duration, platform: platform,
                userEmail: email, prepNotes: prep, showedSpicy: showSpicy.toString()
            };

            try {
                const response = await fetch(`${SCRIPT_URL}?${new URLSearchParams(sheetData).toString()}`);
                const result = await response.json();
                if (result.status !== "success") { throw new Error(result.message || 'Failed to log to sheet'); }
                console.log('Date successfully logged to sheet.');

                document.getElementById('bookingForm').style.display = 'none'; 
                document.getElementById('confirmation').style.display = 'block';
                document.getElementById('confirmation').scrollIntoView({ behavior: 'smooth' });
                for (let i=0; i<25; i++) { setTimeout(()=>createHearts(), i*150); }
            } catch (error) {
                console.error('Error submitting booking:', error);
                alert(`There was an error scheduling your date: ${error.message}. Please try again.`);
            } finally {
                submitButton.disabled = false;
                submitButton.innerHTML = originalButtonText;
            }
        }
        
        async function submitSuggestion(event) { 
            event.preventDefault();
            const submitButton = event.target.querySelector('button[type="submit"]');
            const originalButtonText = submitButton.innerHTML;
            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';

            const title = document.getElementById('suggestionTitle').value;
            const description = document.getElementById('suggestionDescription').value;
            const category = document.getElementById('suggestionCategory').value;
            const spicy = document.getElementById('suggestionSpicy').value;

            const sheetData = {
                action: "addSuggestion", title: title, description: description,
                category: category, spicy: spicy || "", submitterInfo: "Website User"
            };
            
            try {
                const response = await fetch(`${SCRIPT_URL}?${new URLSearchParams(sheetData).toString()}`);
                const result = await response.json();
                if (result.status === "success") {
                    console.log('Suggestion sent to sheet!'); 
                    document.getElementById('suggestionForm').style.display = 'none'; 
                    document.getElementById('suggestionConfirmation').style.display = 'block';
                    document.getElementById('suggestionConfirmation').scrollIntoView({ behavior: 'smooth' }); 
                    document.getElementById('customDateForm').reset();
                    for (let i=0; i<15; i++) { setTimeout(()=>createHearts(), i*150); }
                } else { throw new Error(result.message || 'Failed to send suggestion to sheet'); }
            } catch (error) {
                console.error('Error submitting suggestion:', error);
                alert(`There was an error submitting your suggestion: ${error.message}. Please try again.`);
            } finally {
                submitButton.disabled = false;
                submitButton.innerHTML = originalButtonText;
            }
        }
        
        function resetForm() { 
            document.getElementById('dateForm').reset(); 
            document.getElementById('customDateForm').reset();
            document.getElementById('result').style.display = 'none'; 
            document.getElementById('confirmation').style.display = 'none';
            document.getElementById('suggestionForm').style.display = 'none'; 
            document.getElementById('suggestionConfirmation').style.display = 'none';
            document.getElementById('scheduledDatesDisplay').style.display = 'none'; 
            document.querySelectorAll('.mood-btn').forEach(btn=>btn.classList.remove('active')); 
            selectedMood = '';
        }
        
        function createHearts() { 
            const heartsContainer = document.getElementById('hearts-container');
            if (!heartsContainer) return; 
            const heart = document.createElement('div'); 
            heart.className = 'heart'; 
            heart.innerHTML = ['â¤ï¸','ðŸ’–','ðŸ’˜','ðŸ’','ðŸ’“','ðŸ’—'][Math.floor(Math.random()*6)];
            heart.style.left = Math.random()*100+'vw'; 
            heart.style.animationDuration = 5+Math.random()*5+'s';
            heart.style.animationDelay = Math.random()*2+'s'; 
            heart.style.fontSize = (20+Math.random()*30)+'px';
            heartsContainer.appendChild(heart);
            setTimeout(()=>heart.remove(), 8000);
        }
        
        function setActiveNav() { 
            const leftNavItems = document.querySelectorAll('.nav-container-left .nav-item');
            const rightNavItems = document.querySelectorAll('.nav-container-right .nav-item');
            const allNavItems = [...leftNavItems, ...rightNavItems];
            let path = window.location.pathname.split('/').pop();
            if (path === "" || path === "index.html") { path = "index.html"; }
            allNavItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === path) { item.classList.add('active'); }
            });
        }

        // --- Functions for Scheduled Dates ---
        const viewScheduledDatesBtn = document.getElementById('viewScheduledDatesBtn');
        const scheduledDatesDisplayDiv = document.getElementById('scheduledDatesDisplay');
        const scheduledDatesListDiv = document.getElementById('scheduledDatesList');

        if (viewScheduledDatesBtn) {
            viewScheduledDatesBtn.addEventListener('click', fetchAndDisplayScheduledDates);
        }

        async function fetchAndDisplayScheduledDates() {
            if (!scheduledDatesDisplayDiv || !scheduledDatesListDiv) return;

            document.getElementById('result').style.display = 'none';
            document.getElementById('bookingForm').style.display = 'none';
            document.getElementById('suggestionForm').style.display = 'none';
            document.getElementById('confirmation').style.display = 'none';
            document.getElementById('suggestionConfirmation').style.display = 'none';

            scheduledDatesListDiv.innerHTML = '<p class="loading-indicator" style="display:block;">Loading scheduled dates...</p>';
            scheduledDatesDisplayDiv.style.display = 'block';
            scheduledDatesDisplayDiv.scrollIntoView({ behavior: 'smooth' });

            try {
                const response = await fetch(`${SCRIPT_URL}?action=getScheduledDates&cb=${new Date().getTime()}`);
                if (!response.ok) {
                    throw new Error(`Network response was not ok: ${response.statusText}`);
                }
                const data = await response.json();

                if (data.status === "error") {
                    throw new Error(data.message || "Failed to fetch scheduled dates from script.");
                }
                displayScheduledDates(data);
            } catch (error) {
                console.error('Error fetching/displaying scheduled dates:', error);
                scheduledDatesListDiv.innerHTML = `<p style="color: red;">Error: Could not load scheduled dates. ${error.message}</p>`;
            }
        }

        function displayScheduledDates(dates) {
            if (!scheduledDatesListDiv) return;
            scheduledDatesListDiv.innerHTML = ''; 

            if (!dates || dates.length === 0) {
                scheduledDatesListDiv.innerHTML = '<p class="no-dates-message">No (approved) dates scheduled yet. Time to plan something magical! âœ¨</p>';
                return;
            }

            dates.sort((a, b) => new Date(a.scheduledDate) - new Date(b.scheduledDate)); 

            const ul = document.createElement('ul');
            // ul.style.listStyleType = 'none'; // Handled by CSS
            // ul.style.padding = '0'; // Handled by CSS

            dates.forEach(dateEntry => {
                const li = document.createElement('li');
                li.className = 'scheduled-date-item';

                let scheduledDateTime;
                if (dateEntry.scheduledDate && dateEntry.scheduledDate.includes('T')) { 
                    scheduledDateTime = new Date(dateEntry.scheduledDate);
                } else if (dateEntry.scheduledDate && dateEntry.scheduledTime) { 
                    const timeParts = dateEntry.scheduledTime.split(':');
                    scheduledDateTime = new Date(dateEntry.scheduledDate); 
                    scheduledDateTime.setHours(parseInt(timeParts[0]));
                    scheduledDateTime.setMinutes(parseInt(timeParts[1]));
                    scheduledDateTime.setSeconds(0); 
                } else if (dateEntry.scheduledDate) { 
                    scheduledDateTime = new Date(dateEntry.scheduledDate);
                    scheduledDateTime = new Date(Date.UTC(scheduledDateTime.getFullYear(), scheduledDateTime.getMonth(), scheduledDateTime.getDate()));
                } else {
                    li.innerHTML = '<h4>Invalid Date Entry</h4><p>Could not display this scheduled date.</p>';
                    ul.appendChild(li);
                    return; 
                }
                
                const formattedDate = scheduledDateTime.toLocaleDateString('en-US', {
                    timeZone: 'UTC', 
                    weekday: 'long', month: 'long', day: 'numeric', year: 'numeric'
                });
                const formattedTime = scheduledDateTime.toLocaleTimeString('en-US', {
                    timeZone: 'UTC',
                    hour: '2-digit', minute: '2-digit', hour12: true
                });

                let detailsHTML = `<h4>${dateEntry.ideaTitle}</h4>`;
                detailsHTML += `<div class="date-details-grid">`;
                detailsHTML += `<div class="date-detail"><p><strong>When:</strong> ${formattedDate} at ${formattedTime}</p></div>`;
                detailsHTML += `<div class="date-detail"><p><strong>Duration:</strong> ${dateEntry.duration || 'Not specified'}</p></div>`;
                detailsHTML += `<div class="date-detail"><p><strong>Platform:</strong> ${dateEntry.platform || 'Not specified'}</p></div>`;
                if (dateEntry.prepNotes) {
                    detailsHTML += `<div class="date-detail" style="grid-column: 1 / -1;"><p><strong>Prep:</strong> ${dateEntry.prepNotes}</p></div>`;
                }
                detailsHTML += `</div>`; 


                if (dateEntry.showedSpicyInfo) {
                    detailsHTML += `<p style="color: var(--accent); font-style: italic; margin-top: 10px;">(Spicy version was viewed! ðŸ”¥)</p>`;
                }
                const bookingTimestamp = dateEntry.schedulingTimestamp ? new Date(dateEntry.schedulingTimestamp).toLocaleDateString() : 'N/A';
                detailsHTML += `<p><em><small>(Booked on: ${bookingTimestamp})</small></em></p>`;

                li.innerHTML = detailsHTML;
                ul.appendChild(li);
            });
            scheduledDatesListDiv.appendChild(ul);
        }
        // --- End of Functions for Scheduled Dates ---

        window.onload = function() {
            const dateInput = document.getElementById('date');
            if(dateInput) dateInput.min = new Date().toISOString().split('T')[0];
            
            for (let i = 0; i < 15; i++) { setTimeout(()=>createHearts(), i * 300); }
            setActiveNav(); 
            loadDateIdeas(); 
        };
    </script>
</body>
</html>