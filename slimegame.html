<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slime Care Game | Happy Birthday!</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Pacifico&display=swap" rel="stylesheet">
    <style>
        /* ===== GENERAL STYLES (from original index.html) ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f1a1c2;
            color: #333;
            min-height: 100vh;
            padding-left: 100px;
            text-align: center;
            position: relative;
            overflow-x: hidden;
        }

        /* ===== KUROMI NAVIGATION BAR (from original index.html) ===== */
        .nav-container {
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            width: 100px;
            background-color: #2a0a3a;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 30px;
            z-index: 1000;
            box-shadow: 4px 0 10px rgba(0, 0, 0, 0.2);
            border-right: 3px solid #ff9ec6;
        }

        .nav-item {
            width: 100%;
            text-align: center;
            padding: 15px 0;
            margin: 10px 0;
            color: white;
            font-size: 0.9em;
            text-decoration: none;
            transition: all 0.3s;
        }

        .nav-item:hover {
            background-color: #9b4d96;
            transform: scale(1.05);
        }

        .nav-item img {
            width: 50px;
            height: 50px;
            object-fit: contain;
            margin-bottom: 8px;
        }

        .active {
            background-color: #ff66a3;
            font-weight: bold;
        }

        /* ===== MAIN CONTENT WRAPPER (from original index.html) ===== */
        .page-wrapper {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }

        /* ===== HEADER STYLES (from original index.html) ===== */
        header {
            background-color: #9b4d96;
            color: white;
            padding: 20px;
            font-size: 2em;
            text-transform: uppercase;
            font-weight: bold;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        /* ===== MAIN CONTENT STYLES (from original index.html) ===== */
        main {
            width: 100%;
            padding: 40px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 40px;
            position: relative;
            display: flex; /* Added for centering slime game elements */
            flex-direction: column; /* Added for centering slime game elements */
            align-items: center; /* Added for centering slime game elements */
        }

        /* ===== DECORATIVE ELEMENTS (from original index.html) ===== */
        .bow {
            position: absolute;
            width: 40px;
            height: 40px;
            background: url('https://i.imgur.com/tA7aPg4.png') center/contain no-repeat;
            z-index: 10;
        }

        .hearts-container {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .heart {
            position: absolute;
            width: 30px;
            height: 30px;
            color: #f5a9bc;
            font-size: 30px;
            opacity: 0.7;
            animation: floatUp 15s linear infinite;
        }

        @keyframes floatUp {
            0% { transform: translateY(100vh) scale(0.5) rotate(0deg); opacity: 0; }
            10% { opacity: 0.7; }
            90% { opacity: 0.7; }
            100% { transform: translateY(-20vh) scale(1.2) rotate(360deg); opacity: 0; }
        }

        .header-bow-left { top: -15px; left: -15px; }
        .header-bow-right { top: -15px; right: -15px; }
        .main-bow-tl { top: -15px; left: -15px; }
        .main-bow-tr { top: -15px; right: -15px; }
        .main-bow-bl { bottom: -15px; left: -15px; }
        .main-bow-br { bottom: -15px; right: -15px; }

        /* ===== RESPONSIVE STYLES (from original index.html) ===== */
        @media (max-width: 768px) {
            body {
                padding-left: 80px;
            }
            .nav-container {
                width: 80px;
            }
            .nav-item {
                font-size: 0; /* Hide text on small screens if only icon is desired */
                padding: 15px 0;
            }
            .nav-item img { /* Ensure image is visible if text is hidden */
                width: 40px;
                height: 40px;
                margin-bottom: 0;
            }
            .nav-item span { /* For emoji icon */
                font-size: 24px !important;
            }
            header {
                font-size: 1.8em;
                padding: 15px;
            }
            main {
                padding: 25px;
            }
            /* Adjust slime game elements for smaller screens if needed */
            #slimeCanvas {
                width: 100% !important; /* Make canvas responsive */
                max-width: 350px !important; /* Max width for canvas */
                height: auto !important; /* Adjust height proportionally */
            }
            .status-bars {
                flex-direction: column;
                width: 90% !important;
                gap: 10px !important;
            }
            .bar-container {
                width: 100% !important; /* Full width in column layout */
            }
            .customization {
                width: 90% !important;
            }
        }

        /* ===== SLIME GAME SPECIFIC STYLES ===== */
        #slimeCanvas {
            border: 3px solid #a0d2eb; /* Light blue border */
            background-color: #e0ffff; /* Light cyan background for canvas */
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 10px;
            margin-bottom: 20px;
            /* width and height are set in JS, but can provide max here */
            max-width: 400px;
        }

        .status-bars {
            display: flex;
            gap: 20px; /* Space between bars */
            margin-bottom: 20px;
            width: 100%;
            max-width: 380px; /* Match canvas width roughly */
            justify-content: space-around;
        }

        .status-bar {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 14px;
            font-family: 'Poppins', sans-serif;
        }

        .status-bar label {
            margin-bottom: 5px;
            font-weight: bold;
        }

        .bar-container {
            width: 150px;
            height: 20px;
            background-color: #e0e0e0;
            border: 1px solid #ccc;
            border-radius: 5px;
            overflow: hidden; /* Important for the fill */
            margin-bottom: 5px;
        }

        .bar-fill {
            height: 100%;
            background-color: #4CAF50; /* Green for positive */
            width: 100%; /* Start full */
            transition: width 0.3s ease-in-out, background-color 0.3s ease-in-out;
        }

        .controls {
            margin-bottom: 15px;
        }

        .controls button { /* Slime game action buttons */
            padding: 10px 20px;
            font-size: 1em; /* Use em for better scalability */
            font-family: 'Poppins', sans-serif;
            margin: 5px;
            border: none;
            border-radius: 8px; /* Slightly less rounded than nav-buttons */
            cursor: pointer;
            color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.15);
            transition: all 0.2s;
        }

        .controls button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        #feedButton {
            background-color: #f9a825; /* Orange for food */
        }
        #feedButton:hover {
            background-color: #f57f17;
        }

        #playButton {
            background-color: #66bb6a; /* Green for play */
        }
        #playButton:hover {
            background-color: #43a047;
        }

        .customization {
            background-color: #fff8fa; /* Light cream, matching quote background */
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 0 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            width: 100%;
            max-width: 380px;
            text-align: center;
        }

        .customization h3 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #9b4d96; /* Match site's theme color */
            font-family: 'Pacifico', cursive; /* Match celebration status font */
            font-size: 1.5em;
        }

        .customization p {
            margin: 5px 0 8px 0;
            font-weight: bold;
            color: #7c3c79; /* Darker version of theme color */
            font-family: 'Poppins', sans-serif;
        }

        .color-picker, .hat-picker {
            margin-bottom: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }
        .color-picker p, .hat-picker p {
            margin-right: 10px;
        }

        .color-btn {
            width: 30px;
            height: 30px;
            border: 2px solid #ccc;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0;
            transition: transform 0.2s, border-color 0.2s;
        }
        .color-btn:hover {
            transform: scale(1.1);
            border-color: #888;
        }

        .hat-btn {
            padding: 5px 10px;
            font-size: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f0f0f0;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
        }
        .hat-btn:hover {
            background-color: #e0e0e0;
            transform: scale(1.1);
        }

        #slimeMessage {
            font-size: 1.1em;
            font-family: 'Poppins', sans-serif;
            color: #555;
            min-height: 25px;
            font-style: italic;
            margin-top: 10px;
        }

    </style>
</head>
<body>
 <!-- Navigation -->
    <div class="nav-container">
        <a href="index.html" class="nav-item home">
            <img src="https://i.imgur.com/ZAl2gbp.png" alt="Home">
            Home
        </a>
        <a href="loveletters.html" class="nav-item letters">
            <img src="https://i.imgur.com/ZVhcvD8.png" alt="Love Letters">
            Love Letters
        </a>
        <a href="lovecalculator.html" class="nav-item calculator">
            <img src="https://i.imgur.com/megzmKr.png" alt="Love Calculator">
            Love Calculator
        </a>
        <a href="movies.html" class="nav-item movies">
            <img src="https://i.imgur.com/gzW8uSH.png" alt="Movie Picker">
            Movie Picker
        </a>
        <a href="bookdate.html" class="nav-item bookdate">
            <img src="https://i.imgur.com/megzmKr.png" alt="Book a Date"> <!-- Re-used icon, consider specific one -->
            Book a Date
        </a>
        <a href="timezone.html" class="nav-item timezone">
            <img src="https://i.imgur.com/ZwOw9QN.png" alt="Time Bridge">
            Time Bridge
        </a>
        <a href="slimegame.html" class="nav-item slimegame"> <!-- Added Slime Game -->
            <img src="https://i.imgur.com/QY1Y0nC.png" alt="Slime Game Icon"> <!-- Placeholder Slime Icon -->
            Slime Game
        </a>
    </div>

    <div class="page-wrapper">
        <header>
            Slime Pet Care 💖
            <img src="https://i.imgur.com/tA7aPg4.png" class="bow header-bow-left">
            <img src="https://i.imgur.com/tA7aPg4.png" class="bow header-bow-right">
        </header>

        <main>
            <img src="https://i.imgur.com/tA7aPg4.png" class="bow main-bow-tl">
            <img src="https://i.imgur.com/tA7aPg4.png" class="bow main-bow-tr">
            <img src="https://i.imgur.com/tA7aPg4.png" class="bow main-bow-bl">
            <img src="https://i.imgur.com/tA7aPg4.png" class="bow main-bow-br">
            
            <!-- Slime Game Content Starts Here -->
            <canvas id="slimeCanvas" width="400" height="300"></canvas>

            <div class="status-bars">
                <div class="status-bar">
                    <label for="hungerBar">Hunger:</label>
                    <div class="bar-container">
                        <div id="hungerBar" class="bar-fill"></div>
                    </div>
                    <span id="hungerValue">100/100</span>
                </div>
                <div class="status-bar">
                    <label for="happinessBar">Happiness:</label>
                    <div class="bar-container">
                        <div id="happinessBar" class="bar-fill"></div>
                    </div>
                    <span id="happinessValue">100/100</span>
                </div>
            </div>

            <div class="controls">
                <button id="feedButton">Feed Slime 🍖</button>
                <button id="playButton">Play with Slime 😊</button>
            </div>

            <div class="customization">
                <h3>Customize Your Slime!</h3>
                <div class="color-picker">
                    <p>Color:</p>
                    <button class="color-btn" data-color="rgba(144, 238, 144, 0.9)" style="background-color: lightgreen;">Green</button>
                    <button class="color-btn" data-color="rgba(135, 206, 250, 0.9)" style="background-color: lightskyblue;">Blue</button>
                    <button class="color-btn" data-color="rgba(255, 182, 193, 0.9)" style="background-color: lightpink;">Pink</button>
                    <button class="color-btn" data-color="rgba(255, 215, 0, 0.9)" style="background-color: gold;">Gold</button>
                    <button class="color-btn" data-color="rgba(221, 160, 221, 0.9)" style="background-color: plum;">Plum</button>
                </div>
                <div class="hat-picker">
                    <p>Hat:</p>
                    <button class="hat-btn" data-hat="👑">👑</button>
                    <button class="hat-btn" data-hat="🎩">🎩</button>
                    <button class="hat-btn" data-hat="🥳">🥳</button>
                    <button class="hat-btn" data-hat="⭐">⭐</button>
                    <button class="hat-btn" data-hat="🍓">🍓</button>
                    <button class="hat-btn" data-hat="none">No Hat</button>
                </div>
            </div>
            <p id="slimeMessage">Your slime is content.</p>
            <!-- Slime Game Content Ends Here -->
        </main>
    </div>

    <!-- Floating Hearts -->
    <div class="hearts-container" id="hearts-container"></div>

    <script>
        // Create floating hearts (from original index.html)
        function createHearts() {
            const container = document.getElementById('hearts-container');
            if (!container) return; // Guard clause
            // Clear only if you want to refresh them, otherwise they accumulate or run their course
            // container.innerHTML = ''; 
            
            const heartCount = container.children.length;
            if (heartCount > 50) return; // Limit total hearts on screen to prevent performance issues

            for (let i = 0; i < 15; i++) { // Add fewer hearts per call to avoid too many at once
                const heart = document.createElement('div');
                heart.className = 'heart';
                heart.innerHTML = '❤️'; // Or use other heart emojis like 💜 💖
                heart.style.left = `${Math.random() * 100}vw`;
                heart.style.animationDuration = `${10 + Math.random() * 10}s`; // Slightly faster range
                heart.style.animationDelay = `${Math.random() * 5}s`;
                heart.style.fontSize = `${15 + Math.random() * 15}px`; // Smaller hearts
                heart.style.opacity = `${0.5 + Math.random() * 0.4}`; // Vary opacity
                container.appendChild(heart);

                // Optional: remove heart after animation to clean up DOM
                heart.addEventListener('animationend', () => {
                    heart.remove();
                });
            }
        }
        
        // Highlight current page in nav (from original index.html, slightly improved)
        function setActiveNav() {
            const navItems = document.querySelectorAll('.nav-container .nav-item');
            let path = window.location.pathname.split("/").pop();
            if (path === "") {
                path = "index.html"; // Default to index.html if at root
            }

            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === path) {
                    item.classList.add('active');
                }
            });
        }

        // ===== SLIME GAME SCRIPT =====
        const canvas = document.getElementById('slimeCanvas');
        const ctx = canvas.getContext('2d');

        const feedButton = document.getElementById('feedButton');
        const playButton = document.getElementById('playButton');

        const hungerBar = document.getElementById('hungerBar');
        const happinessBar = document.getElementById('happinessBar');
        const hungerValueDisplay = document.getElementById('hungerValue');
        const happinessValueDisplay = document.getElementById('happinessValue');
        const slimeMessage = document.getElementById('slimeMessage');

        const colorButtons = document.querySelectorAll('.color-btn');
        const hatButtons = document.querySelectorAll('.hat-btn');

        const MAX_STAT = 100;
        const STAT_DECAY_RATE = 1; // Decrease per tick
        const FEED_AMOUNT = 30;
        const PLAY_AMOUNT = 25;
        const TICK_INTERVAL = 2000; // Milliseconds (2 seconds)

        let slime = {
            hunger: MAX_STAT,
            happiness: MAX_STAT,
            x: canvas.width / 2,
            y: canvas.height - 70,
            baseWidth: 100,
            baseHeight: 60,
            baseColor: 'rgba(144, 238, 144, 0.9)', // Default base color
            color: 'rgba(144, 238, 144, 0.9)',    // Current rendered color
            hat: null, 
            hatSize: 35, 
            eyeColor: 'black',
            pupilColor: 'white',
            eyeOffsetX: 20,
            eyeOffsetY: -10,
            eyeRadius: 10,
            pupilRadius: 4,
            mouthType: 'smile',
            isBouncing: false,
            bounceHeight: 0,
            animationTimer: 0
        };

        function drawSlime() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            let currentHeight = slime.baseHeight - slime.bounceHeight;
            let currentY = slime.y + slime.bounceHeight / 2;
            let slimeTopY = currentY - currentHeight / 2;

            ctx.fillStyle = slime.color;
            ctx.beginPath();
            ctx.moveTo(slime.x - slime.baseWidth / 2, currentY + currentHeight / 2);
            ctx.quadraticCurveTo(slime.x - slime.baseWidth / 3, slimeTopY - 10, slime.x, slimeTopY);
            ctx.quadraticCurveTo(slime.x + slime.baseWidth / 3, slimeTopY - 10, slime.x + slime.baseWidth / 2, currentY + currentHeight / 2);
            ctx.quadraticCurveTo(slime.x, currentY + currentHeight / 2 + 20, slime.x - slime.baseWidth / 2, currentY + currentHeight / 2);
            ctx.closePath();
            ctx.fill();

            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.beginPath();
            ctx.ellipse(slime.x, slime.y + slime.baseHeight / 2 + 5, slime.baseWidth / 2, 5, 0, 0, Math.PI * 2);
            ctx.fill();

            if (slime.hat && slime.hat !== 'none') {
                ctx.font = `${slime.hatSize}px 'Poppins', sans-serif`; // Using site font
                ctx.textAlign = 'center';
                let hatYPosition = slimeTopY - (slime.hatSize * 0.1); 
                if (slime.hat === '🍓') hatYPosition -=5; 
                ctx.fillText(slime.hat, slime.x, hatYPosition);
            }

            const leftEyeX = slime.x - slime.eyeOffsetX;
            const rightEyeX = slime.x + slime.eyeOffsetX;
            const eyeY = currentY + slime.eyeOffsetY;

            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(leftEyeX, eyeY, slime.eyeRadius, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(rightEyeX, eyeY, slime.eyeRadius, 0, Math.PI * 2);
            ctx.fill();

            ctx.fillStyle = slime.eyeColor;
            let pupilOffsetY = 0;
            if (slime.mouthType === 'happy' || slime.mouthType === 'smile') pupilOffsetY = -2;
            if (slime.mouthType === 'sad') pupilOffsetY = 2;

            ctx.beginPath();
            ctx.arc(leftEyeX, eyeY + pupilOffsetY, slime.pupilRadius, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(rightEyeX, eyeY + pupilOffsetY, slime.pupilRadius, 0, Math.PI * 2);
            ctx.fill();

            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.beginPath();
            const mouthY = eyeY + slime.eyeRadius + 5;
            switch (slime.mouthType) {
                case 'smile':
                case 'happy':
                    ctx.arc(slime.x, mouthY, 10, 0, Math.PI);
                    break;
                case 'ooh':
                    ctx.arc(slime.x, mouthY + 5, 5, 0, Math.PI * 2);
                    break;
                case 'sad':
                    ctx.arc(slime.x, mouthY + 10, 10, Math.PI, Math.PI * 2);
                    break;
                case 'neutral':
                default:
                    ctx.moveTo(slime.x - 10, mouthY + 5);
                    ctx.lineTo(slime.x + 10, mouthY + 5);
                    break;
            }
            ctx.stroke();
        }

        function updateStatusBars() {
            const hungerPercent = (slime.hunger / MAX_STAT) * 100;
            hungerBar.style.width = hungerPercent + '%';
            hungerValueDisplay.textContent = `${Math.round(slime.hunger)}/${MAX_STAT}`;
            if (hungerPercent < 30) hungerBar.style.backgroundColor = '#f44336';
            else if (hungerPercent < 60) hungerBar.style.backgroundColor = '#ffeb3b';
            else hungerBar.style.backgroundColor = '#4CAF50';

            const happinessPercent = (slime.happiness / MAX_STAT) * 100;
            happinessBar.style.width = happinessPercent + '%';
            happinessValueDisplay.textContent = `${Math.round(slime.happiness)}/${MAX_STAT}`;
            if (happinessPercent < 30) happinessBar.style.backgroundColor = '#f44336';
            else if (happinessPercent < 60) happinessBar.style.backgroundColor = '#ffeb3b';
            else happinessBar.style.backgroundColor = '#4CAF50';
        }

        function determineSlimeColorAndExpression() {
            if (slime.hunger < 30 || slime.happiness < 30) {
                slime.mouthType = 'sad';
                slime.color = slime.baseColor.replace(/0\.9\)$/, '0.6)'); 
                setMessage("Your slime looks sad and hungry!");
            } else if (slime.hunger < 60 || slime.happiness < 60) {
                slime.mouthType = 'neutral';
                slime.color = slime.baseColor.replace(/0\.9\)$/, '0.75)'); 
                setMessage("Your slime seems a bit bored or peckish.");
            } else {
                slime.mouthType = 'smile';
                slime.color = slime.baseColor; 
                setMessage("Your slime is content!");
            }
        }

        function updateSlimeState() {
            slime.hunger -= STAT_DECAY_RATE;
            slime.happiness -= STAT_DECAY_RATE;

            slime.hunger = Math.max(0, slime.hunger);
            slime.happiness = Math.max(0, slime.happiness);

            if (slime.animationTimer <= 0) {
                determineSlimeColorAndExpression();
            } else {
                slime.animationTimer--;
                if (slime.animationTimer === 0) {
                    slime.isBouncing = false;
                    slime.bounceHeight = 0;
                    determineSlimeColorAndExpression();
                }
            }

            if (slime.isBouncing) {
                slime.bounceHeight = Math.abs(Math.sin(Date.now() * 0.01)) * 10;
            }

            updateStatusBars();
            drawSlime();
        }

        function feedSlime() {
            if (slime.hunger < MAX_STAT) {
                slime.hunger = Math.min(MAX_STAT, slime.hunger + FEED_AMOUNT);
                slime.happiness = Math.min(MAX_STAT, slime.happiness + PLAY_AMOUNT / 3);
                setMessage("Yum! Slime enjoyed the food!");
                slime.mouthType = 'ooh';
                slime.color = 'rgba(173, 255, 47, 0.95)'; 
                slime.animationTimer = 5;
                triggerBounce();
            } else {
                setMessage("Slime is already full!");
            }
            updateStatusBars(); // Ensure bars update even if already full
            drawSlime(); // Redraw for any immediate visual feedback
        }

        function playWithSlime() {
            if (slime.happiness < MAX_STAT) {
                slime.happiness = Math.min(MAX_STAT, slime.happiness + PLAY_AMOUNT);
                setMessage("Whee! Slime had fun playing!");
                slime.mouthType = 'happy';
                slime.color = 'rgba(135, 206, 250, 0.95)'; 
                slime.animationTimer = 5;
                triggerBounce(true);
            } else {
                setMessage("Slime is perfectly happy right now!");
            }
            updateStatusBars();
            drawSlime();
        }

        function triggerBounce(longer = false) {
            slime.isBouncing = true;
            setTimeout(() => {
                if (slime.animationTimer <= 0) {
                     slime.isBouncing = false;
                     slime.bounceHeight = 0;
                     drawSlime(); // Redraw to stop bounce
                }
            }, longer ? 1500 : 750);
        }

        function setMessage(msg) {
            slimeMessage.textContent = msg;
        }

        colorButtons.forEach(button => {
            button.addEventListener('click', () => {
                slime.baseColor = button.dataset.color;
                if (slime.animationTimer <= 0) {
                    determineSlimeColorAndExpression();
                }
                drawSlime(); 
            });
        });

        hatButtons.forEach(button => {
            button.addEventListener('click', () => {
                const newHat = button.dataset.hat;
                slime.hat = (newHat === 'none') ? null : newHat;
                drawSlime(); 
            });
        });

        feedButton.addEventListener('click', feedSlime);
        playButton.addEventListener('click', playWithSlime);
        
        let gameIntervalId = null;

        function startGame() {
            determineSlimeColorAndExpression(); 
            drawSlime();
            updateStatusBars();
            if(gameIntervalId) clearInterval(gameIntervalId); // Clear previous interval if any
            gameIntervalId = setInterval(updateSlimeState, TICK_INTERVAL);
        }
        // ===== END OF SLIME GAME SCRIPT =====


        // Initialize on page load
        window.addEventListener('load', () => {
            createHearts(); // For background ambiance
            setInterval(createHearts, 15000); // Periodically add more hearts
            setActiveNav(); // Set active navigation item

            // Start the slime game
            if (canvas && feedButton && playButton) { // Ensure all game elements are present
                 startGame();
            }
        });
    </script>
</body>
</html>